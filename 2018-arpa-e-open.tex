%        File: 2018-arpa-e-open.tex
%     Created: Tue Feb 06 01:00 PM 2018 C
% Last Change: Tue Feb 06 01:00 PM 2018 C
%
\documentclass[letterpaper,12pt]{article}
\usepackage[top=1in,bottom=1.0in,left=1.0in,right=1.0in,headsep=0.5in]{geometry}
\usepackage{verbatim}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{longtable}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{paralist}
\usepackage{lastpage}
\usepackage[numbers,sort,compress]{natbib}
\usepackage{placeins}

%-----------------------------------------------------------

\usepackage{graphicx}  % Required for including images

\usepackage{tabularx}
\newcolumntype{b}{X}
\newcolumntype{s}{>{\hsize=.5\hsize}X}
\newcolumntype{m}{>{\hsize=.75\hsize}X}
\newcolumntype{z}{>{\hsize=.65\hsize}X}

\usepackage{booktabs} % Top and bottom rules for tables
\usepackage{xspace}
\usepackage{tikz}
\usepackage{chronology}
\usetikzlibrary{arrows.meta,backgrounds}

\usetikzlibrary{positioning, arrows, decorations, shapes, calc}
% Define block styles
\tikzstyle{decision} = [diamond, draw, fill=blue!20,
text width=4.5em, text badly centered, node distance=3cm, inner sep=0pt]

\tikzstyle{const} = [rectangle, draw, text centered, fill=orange!20]
\tikzstyle{data} = [rectangle, draw, text centered, fill=green!20]

\tikzstyle{block} = [rectangle, draw, text centered, fill=blue!20]
\tikzstyle{line} = [draw, -latex']
\tikzstyle{cloud} = [draw, ellipse,fill=red!20, node distance=6em,
minimum height=2em]


\usetikzlibrary{shapes.multipart}
\usetikzlibrary{positioning}

%-----------------------------------------------------------


\usepackage[hidelinks]{hyperref}
\def\thesection       {\arabic{section}.}
\def\thesubsection     {\thesection.\alph{subsection}}

\usepackage{titlesec}

\titleformat{\section}
  {\normalfont\fontsize{12}{14}\bfseries}{\thesection}{1em}{}
\titlespacing{\section}{0pt}{12pt plus 4pt minus 2pt}{0pt plus 2pt minus 2pt}


%-----------------------------------------------------------
% Bib Entry Separation
\setlength{\bibsep}{0pt plus 0.3ex}
%-----------------------------------------------------------

%\author{{\fourteenpt University of Illinois (Urbana, IL); Kathryn Huff}}

\date{}
%\title{{\fourteenpt Machine Learning Acceleration of Monte Carlo Neutron Transport}}


%
% The ARPA-E assigned Control Number, the Lead Organization Name, and the
% Principal Investigatorâ€™s Last Name must be prominently displayed on the upper
% right corner of the header of every page. Page numbers must be included in the
%footer of every page.
%
\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}

\rhead{U. Illinois, Huff\\
       \#1858-3501}
\lhead{DE-FOA-0001858\\
Concept Paper}
\cfoot{
Contains Confidential, Proprietary, or Privileged Information\\ 
    Exempt from Public Disclosure\\ 
    Page~\thepage\ of~\pageref{LastPage}}
\newcommand*\fourteenpt{\fontsize{14}{15.5}\selectfont}

\begin{document}
%\maketitle
\thispagestyle{fancy}
\begin{center}
{\fourteenpt Machine Learning Acceleration of Monte Carlo Neutron Transport}\\
\vspace{3mm}
University of Illinois (Urbana, IL); Kathryn Huff\\
\vspace{3mm}
4D: Power Generation and Energy Production: Nuclear Power Generation And Materials\\
Proposed Funds: Fed: \$700,000\/ Cost Share: \$35,000\/ Total: \$735,000\\
Project Duration: 36 Months\\
\end{center}

\section{Concept Summary}
%    Describe the proposed concept with minimal jargon, and explain how it
%               addresses the Program Objectives of the FOA.

High fidelity simulation is at the core of innovative nuclear reactor design,
regulation, and operation. However, the highest fidelity simulations,
which use the Monte Carlo transport method, are computationally intensive.
Efficiency improvements in computational resources and user time may transform
innovative nuclear reactor commercialization.

This work will implement a proof-of-concept python package using machine 
learning techniques to accelerate the Monte Carlo method for neutral particle transport.
Next, this work will implement a few potential acceleration methods inspired 
by promising machine learning and optimization techniques in the literature.
Finally, the acceleration methods will be tested and compared to one another for
problems relevant to advanced nuclear reactor safety and design.
This work will emphasize best practices in
scientific computing, integrate documentation, implement unit
tests, and investigate scalability. 

\section{Innovation and Impact}
%    Clearly identify the problem to be solved with the proposed technology
%              concept.
Methods to speed up neutral particle transport calculations tend to be 
application-specific and require significant user time to set up. Recently, 
efficiency improvements have been conceptually demonstrated for generic Monte 
Carlo methods by using machine learning methods such as Restricted Boltzmann 
Machines\cite{huang_accelerated_2017} and more fundamental Hamiltonian-based 
self-learning\cite{liu_self-learning_2017}. The proposed work will leverage 
these conceptual results to speed up neutral particle transport calculations 
for broad nuclear engineering applications. 
\FloatBarrier

%    Describe how the proposed effort represents an innovative and potentially
%              transformational solution to the technical challenges posed by the FOA.
In particular, traditional `hybrid methods' for variance 
reduction typically apply to either fixed-source or eigenvalue calculations, but not both.
The proposed method can be used on both solution types, offering the potential for
broader applicability. Further, many hybrid
methods use a deterministic solution of the inverse solution to estimate problem
importance\cite{wagner_automated_1998, wagner_automated_2009,
haghighat_monte_2003, zhang_adjoint-based_2011, hoogenboom_optimum_1979} . Though methods exist that automate importance map
generation\cite{hendricks_mcnp_1985, burn_optimizing_2014,
  van_wijk_easy_2011, wagner_automated_1998, wagner_automated_2009,
haghighat_monte_2003, zhang_adjoint-based_2011, hoogenboom_optimum_1979},
they still require user knowledge to choose deterministic
parameter choices (space and energy mesh sizes, quadrature type, quadrature order,
etc.). Selecting these is non-trivial and dramatically affects method 
performance. The proposed work will automate the importance map parameter selection
and generation to reduce user effort as well as user error.
%    Explain the concept's potential to be disruptive compared to existing or
%              emerging technologies.
%    Describe how the concept will have a positive impact on at least one of
%              the ARPA-E mission areas in Section I.A of the FOA.

\begin{table}
  \centering
    \begin{tabular}{  l  c  }
     \hline
     \textbf{Metric} & \textbf{Time Saved}\\ \hline
     Improvement over Monte Carlo Runtime & $\ge50\%$  \\
     Improvement over Hybrid Method Runtime & $20\%-90\%$ \\
     Improvement over Hybrid Method User Time & $\ge10\%$ \\
     \hline
    \end{tabular}
    \caption{The fractional runtime and use time improvements that we expect  to observe with Machine 
            Learning Monte Carlo are significant when compared to either 
            traditional Monte Carlo or Hybrid Methods (deterministic-stochastic 
            acceleration).}
   \label{tab:improve}
\end{table}

The proposed method, which uses machine learning to obtain an
importance map for a desired problem, will dramatically improve existing 
computational methods for reactor analysis.  Accordingly, it will
reduce the computational burden, user effort, and user error in 
achieving results necessary for advanced reactor core design and development.
Consequently, this work
directly applies to the \textbf{ARPA-E funds applied research and development}
mission area described in the FOA. Several realms of potential improvement 
expected from the proposed method and are summarized in Table \ref{tab:improve}.
%    To the extent possible, provide quantitative metrics in a table that
%              compares the proposed technology concept to current and emerging
%              technologies and to the appropriate Technology Category in Section I.D of
%              the FOA.



\section{Proposed Work}
%    Describe the final deliverable(s) for the project and the overall
%             technical approach used to achieve project objectives.

%    Discuss alternative approaches considered, if any, and why the proposed
%             approach is most appropriate for the project objectives.
%    Describe the background, theory, simulation, modeling, experimental data,
%             or other sound engineering and scientific practices or principles that support
%             the proposed approach.  Provide specific examples of supporting data and/or
%             appropriate citations to the scientific and technical literature.
%    Describe why the proposed effort is a significant technical challenge and
%             the key technical risks to the project.  Does the approach require one or more
%             entirely new technical developments to succeed?  How will technical risk be
%             mitigated?
Using Monte Carlo for full-core simulation of nuclear reactors is
computationally expensive\cite{martin_challenges_2012}. However, Monte Carlo is
attractive as a method because it is inherently continuous in space, energy, and
angle, potentially allowing for higher fidelity results in tally regions.
The proposed method may reduce
the variance in the solution we seek but may not overcome the computational
limitations that exist for full-core reactor simulation with Monte Carlo. We plan to
characterize the method on a diverse set of application problems, ranging from
geometrically simple to complex and including either fixed-source or criticality
(eigenvalue) calculations.

Attempts to develop hybrid methods with broad
applicability across phase-space, such as the CADIS
methodology\cite{haghighat_monte_2003}, typically
use a deterministic transport calculation on a coarse mesh solving the inverse problem to obtain an importance
estimate\cite{zhang_global_2014, zhang_adjoint-based_2011, haghighat_monte_2003,
hendricks_mcnp_1985}. The proposed method will use machine learning in a novel space to
update Monte Carlo (as in Figure \ref{fig:model-fig}, but the quality of the 
importance estimate will be limited
by the quality of the results from the initial Monte Carlo simulation. The
problem physics (a very effective shield, a highly absorbing medium, etc.) will
influence particles' ability to penetrate through the problem phase-space, and
this may result in noisy importance estimates in certain regions of the
problems\cite{van_wijk_easy_2011}. Further, this noise may exacerbate overfitting phenomena observed in
machine learning techniques. Because this method has a large phase-space
applicability, it may require a substantial computational burden to investigate
the method performance in different tally types (space, space-energy,
space-energy-angle).

\input{model-fig}


A method that reduces the runtime for full-core reactor core calculations
presents the opportunity to offer the most energy savings in advanced reactor
simulation. Working designs for future reactors have numerous design iterations,
each requiring multiple Monte Carlo runs to simulate the evolution of the
reactor over a lifetime. Among the problems that will be
simulated with this method are:
\begin{compactitem}
  \item A molten salt reactor \cite{robertson_msre_1965}
  \item A pebble bed, fluorite salt-cooled, high temperature
    reactor \cite{andreades_design_2016}, and
  \item A molten salt, single-fluid, breeder
    reactor\cite{robertson_conceptual_1971}.
\end{compactitem}
In addition to energy savings, faster runtime will also allow for faster design
turnaround for different reactor point designs.
%    Identify techno-economic challenges to be overcome for the proposed
%             technology to be commercially relevant.
%    Estimated federal funds requested; total project cost including cost
%             sharing.
\paragraph{Budget} The project has a \$\textbf{700,000} federal budget over a
36 month duration. Funding at UIUC will support, every year for three years: 2
graduate student research assistants, one 50\% supported postdoc, 4 weeks of
faculty summer salary, and other expenses such as conference travel and
publication page charges. Cost sharing will take the form of computational
resources: The PI is a Blue Waters Assistant Professor and accordingly will
use CPU resource allocation on that machine with a value greater than or equal
to 5\% of the total budget of this project. Consequently, no computing
resources are requested from the federal budget portion of this grant, despite
significant high performance computing resources which will be leveraged toward
the products.


\section{Team Organization and Capabilities}
%    Indicate the roles and responsibilities of the organizations and key
%             personnel that comprise the Project Team.
%    Provide the name, position, and institution of each key team member and
%             describe in 1-2 sentences the skills and experience that he/she brings
%             to the team.

\paragraph{Kathryn Huff} is a Blue Waters Assistant Professor at the University
of Illinois at Urbana-Champaign (UIUC) department of Nuclear, Plasma, and
Radiological Engineering (NPRE). She leads the Advanced Reactors and Fuel
Cycles Research Group which focuses on development of nuclear engineering
software such as the Cyclus simulator, PyNE, and Moltres, a MOOSE application
for MSR physics. She will provide insight on scientific computing, the nuclear
fuel cycle, the Moltres tool, and object-oriented multiphysics modeling in
general.

\paragraph{Madicken Munk} is a Postdoctoral Research Scholar at the University
of Illinois at Urbana-Champaign (UIUC) in the National Center for Supercomputing
Applications (NCSA). She will provide expertise in computational methods
development, Monte Carlo radiation transport, and hybrid neutral-particle
transport. Madicken will serve as a reference and mentor on radiation transport
methods and will help oversee the method development.
%    Identify key capabilities provided by the organizations comprising the
%             Project Team and how those key capabilities will be used in the proposed effort

\paragraph{Key Capabilities}

UIUC is a leader in world class computing resources that will be available for compute-
intensive aspects of this work. In particular, the Blue Waters supercomputer is
one of the most powerful supercomputers in the world, and is the fastest
supercomputer on a university campus.
\bibliographystyle{unsrtnat}
\bibliography{2018-arpa-e-open}
\end{document}


